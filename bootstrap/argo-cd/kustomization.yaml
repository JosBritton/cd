apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../install  # argo-cd will own itself
- ./resources/cert.yaml
- ./resources/httpproxy.yaml
- ./resources/delegation.yaml
configMapGenerator:
- name: argocd-cmd-params-cm
  behavior: merge
  literals:
  - server.insecure=true  # proxy HTTP through HTTPs ingress
namespace: argocd  # will reconcile install to argocd namespace
patches:
- target:
    kind: secret
    name: argocd-initial-admin-secret
    namespace: argocd
  patch: |-
    $patch: delete
    apiVersion: v1
    kind: Secret
    metadata:
      name: argocd-initial-admin-secret
      namespace: argocd
